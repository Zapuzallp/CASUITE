<form method="post" enctype="multipart/form-data" class="row g-3" id="businessStructureDetailsForm">
    {% csrf_token %}
    <input type="hidden" name="business_structure" value="HUF">

    <h6 class="card-title mb-3">HUF (Hindu Undivided Family) Details <small class="text-muted">(* indicates required field)</small></h6>

        <!-- Display form-wide errors -->
    {% if form.non_field_errors %}
        <div class="col-12">
            <div class="alert alert-danger">
                <strong>Please correct the following errors:</strong>
                <ul class="mb-0">
                    {% for error in form.non_field_errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    {% endif %}

    <div class="col-md-6">
        <label for="{{ form.huf_name.id_for_label }}" class="form-label">HUF Name <span class="text-danger">*</span></label>
        {{ form.huf_name }}
        {% if form.huf_name.errors %}
            <div class="text-danger small">{{ form.huf_name.errors }}</div>
        {% endif %}
    </div>

    <div class="col-md-6">
        <label for="{{ form.pan_huf.id_for_label }}" class="form-label">HUF PAN Number <span class="text-danger">*</span></label>
        {{ form.pan_huf }}
        {% if form.pan_huf.errors %}
            <div class="text-danger small">{{ form.pan_huf.errors }}</div>
        {% endif %}
    </div>

    <div class="col-md-6">
        <label for="{{ form.date_of_creation.id_for_label }}" class="form-label">Date of Creation <span class="text-danger">*</span></label>
        {{ form.date_of_creation }}
        {% if form.date_of_creation.errors %}
            <div class="text-danger small">{{ form.date_of_creation.errors }}</div>
        {% endif %}
    </div>

    <div class="col-md-6">
        <label for="{{ form.karta_name.id_for_label }}" class="form-label">Karta Name <span class="text-danger">*</span></label>
        {{ form.karta_name }}
        {% if form.karta_name.errors %}
            <div class="text-danger small">{{ form.karta_name.errors }}</div>
        {% endif %}
        {% if not form.karta_name.field.queryset.exists %}
            <div class="text-warning small">No individual clients available. Please create an individual client first.</div>
        {% endif %}
        <small class="form-text text-muted">Select Karta from existing individual clients</small>
    </div>

    <div class="col-md-6">
        <label for="{{ form.number_of_coparceners.id_for_label }}" class="form-label">Number of Coparceners <span class="text-danger">*</span></label>
        {{ form.number_of_coparceners }}
        {% if form.number_of_coparceners.errors %}
            <div class="text-danger small">{{ form.number_of_coparceners.errors }}</div>
        {% endif %}
    </div>

    <div class="col-md-6">
        <label for="{{ form.number_of_members.id_for_label }}" class="form-label">Number of Members <span class="text-danger">*</span></label>
        {{ form.number_of_members }}
        {% if form.number_of_members.errors %}
            <div class="text-danger small">{{ form.number_of_members.errors }}</div>
        {% endif %}
    </div>

    <div class="col-12">
        <label for="{{ form.residential_address.id_for_label }}" class="form-label">Residential Address <span class="text-danger">*</span></label>
        {{ form.residential_address }}
        {% if form.residential_address.errors %}
            <div class="text-danger small">{{ form.residential_address.errors }}</div>
        {% endif %}
    </div>

    <div class="col-12">
        <label for="{{ form.business_activity.id_for_label }}" class="form-label">Business Activity <span class="text-danger">*</span></label>
        {{ form.business_activity }}
        {% if form.business_activity.errors %}
            <div class="text-danger small">{{ form.business_activity.errors }}</div>
        {% endif %}
    </div>

    <div class="col-12">
        <label for="{{ form.bank_account_details.id_for_label }}" class="form-label">Bank Account Details (JSON)</label>
        {{ form.bank_account_details }}
        {% if form.bank_account_details.errors %}
            <div class="text-danger small">{{ form.bank_account_details.errors }}</div>
        {% endif %}
        <small class="form-text text-muted">Enter bank details in JSON format: {"bank_name": "", "account_number": "", "ifsc_code": ""}</small>
    </div>

    <div class="col-md-6">
        <label for="{{ form.deed_of_declaration_file.id_for_label }}" class="form-label">Deed of Declaration File</label>
        {{ form.deed_of_declaration_file }}
        {% if form.deed_of_declaration_file.errors %}
            <div class="text-danger small">{{ form.deed_of_declaration_file.errors }}</div>
        {% endif %}
    </div>

    <div class="col-md-6">
        <label for="{{ form.remarks.id_for_label }}" class="form-label">Remarks</label>
        {{ form.remarks }}
        {% if form.remarks.errors %}
            <div class="text-danger small">{{ form.remarks.errors }}</div>
        {% endif %}
    </div>

    <div class="col-12">
        <div class="d-flex justify-content-between">
            <button type="button" id="backButton" class="btn btn-secondary">Back</button>
            <button type="submit" class="btn btn-primary">Save Client</button>
        </div>
    </div>
</form>